%macro heavyDrinking;data test; set cchs1516.hs1516_on_distr(keep=ont_id alc_020 dhh_age); select(alc_020); when(3,4,5,6) heavyDrinking = 1; when(1,2,96) heavyDrinking = 0; otherwise heavyDrinking = .; end; /*population exclusions*/ if dhh_age < 19 then heavyDrinking = .;run;%mend heavyDrinking;